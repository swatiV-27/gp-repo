pipeline {
    agent any 
     stages {
      stage ('git-pull') {
          steps {
            git branch: 'main', url: 'https://github.com/shubhamkalsait/EasyCRUD.git'
            echo "git pull successful"
          }
      }
       stage ('build') {
           steps {
                 sh '''
                 cd backend
                 echo "build successfull"
                 mvn clean package -DskipTests
                  ''' 
                 dir('backend') {                     
+                   sh 'mvn clean package -DskipTests'
+               }
          }
       }
         stage ("Test") {
            steps {
               withSonarQubeEnv(installationName: 'sonar-cred') {
                        sh '''
                        cd backend
                        mvn sonar:sonar -Dsonar.projectKey=studentapp '''
                    }
                 dir('backend') {
                   withSonarQubeEnv('sonar-cred') { // ðŸ”´ simplified syntax
+                       sh 'mvn sonar:sonar -Dsonar.projectKey=studentapp'
+                   }
            }
        }
       stage ('QualityGate'){
           steps {
            timeout (time: 10, unit: 'MINUTES')  {
             waitForQualityGate abortPipeline: true, credentialsId: 'sonar-cred'
                        }
 }
}
       stage ('deploy') {
           steps {
               echo "deploy successfully"
           }
       }
 }
}
